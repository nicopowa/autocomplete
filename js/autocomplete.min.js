(function(){'use strict';var d,e="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this;function f(a,b){this.a={};this.o(b);this.h=[];this.data=this.a.data;this.j=a;this.g="";this.c=-1;this.i=!1;this.j.classList.add("ac");this.f=document.createElement("input");this.f.setAttribute("type","search");this.f.setAttribute("placeHolder",this.a.prompt);this.j.appendChild(this.f);this.b=document.createElement("div");this.b.style.maxHeight=this.a.maxHeight;this.b.classList.add("ac-items");this.j.appendChild(this.b);a={input:this.l,click:this.v,keydown:this.w,blur:this.u};for(var c in a)this.f.addEventListener(c,
a[c].bind(this));this.b.addEventListener("mousedown",this.A.bind(this))}d=f.prototype;d.l=function(){this.g=this.f.value.toLowerCase();g(this);if(this.a.open||!(this.g.length<this.a.minChars||this.b.childElementCount))h(this).map(this.m,this),this.a.onInput(this.g)};
d.m=function(a){var b=this,c=document.createElement("div");c.innerHTML=this.a.highlight?l(this,a[this.a.label]):a[this.a.label];c.setAttribute("data-value",this.h.findIndex(function(k){return k[b.a.label]==a[b.a.label]}));c.addEventListener("click",this.s.bind(this));this.b.appendChild(c)};function h(a){return a.h.filter(function(b){return-1!=b[a.a.search].toLowerCase().indexOf(a.g)})}
function l(a,b){var c=b.toLowerCase().indexOf(a.g),k=document.createElement("span");k.innerHTML=b.slice(c,c+a.g.length);return b.slice(0,c)+k.outerHTML+b.slice(c+a.g.length,b.length)}d.s=function(a){a=a.target.getAttribute("data-value");var b=this.h[a];this.f.value=b[this.a.label];this.g=this.f.value.toLowerCase();this.i=!1;g(this);this.a.onSelect(b[this.a.field],b,a)};d.v=function(){if(this.b.childElementCount)return g(this);this.a.open&&!this.g?this.h.map(this.m,this):this.l(null)};
d.w=function(a){var b=this.b.childNodes;-1!=[40,38,13,27].indexOf(a.keyCode)&&a.preventDefault();switch(a.keyCode){case 40:-1==this.c&&this.l(null);this.c++;m(this,b);break;case 38:this.c--;m(this,b);break;case 13:if(-1!=this.c)b[this.c].click();else{if(this.a.custom){if(this.f.value.length>=this.a.minChars)this.a.onSelect(this.f.value,void 0,-1)}else 1==this.b.childElementCount&&b[0].click();g(this)}break;case 27:g(this)}};d.u=function(){this.i||g(this)};d.A=function(){this.i=!0};
function m(a,b){if(b.length){for(var c=0,k=b.length;c<k;c++)b[c].classList.remove("ac-active");a.c=0>a.c?b.length-1:a.c>b.length-1?0:a.c;b[a.c].classList.add("ac-active");b[a.c].scrollIntoView()}}function g(a){for(a.c=-1;a.b.firstChild;)a.b.removeChild(a.b.firstChild)}d.o=function(a){this.a=Object.assign(this.a,{prompt:"",open:!1,highlight:!0,custom:!1,maxHeight:"500px",minChars:3,label:"text",search:"text",field:"text",data:[],onInput:function(){},onSelect:function(){}},a)};
e.Object.defineProperties(f.prototype,{value:{configurable:!0,enumerable:!0,set:function(a){this.f.value=a;this.g=a.toLowerCase()},get:function(){var a=this,b=this.h.findIndex(function(c){return c[a.a.label].toLowerCase()==a.g});return-1!=b?this.h[b][this.a.field]:this.a.custom?this.f.value:null}},data:{configurable:!0,enumerable:!0,set:function(a){this.h=a;this.a.search!=this.a.label&&(this.a.highlight=!1)}}});var n=["AutoComplete"],p=this;
n[0]in p||"undefined"==typeof p.execScript||p.execScript("var "+n[0]);for(var q;n.length&&(q=n.shift());)n.length||void 0===f?p[q]&&p[q]!==Object.prototype[q]?p=p[q]:p=p[q]={}:p[q]=f;f.prototype.setOptions=f.prototype.o;}).call(this);
