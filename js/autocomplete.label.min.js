(function(){'use strict';var e;function f(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var g="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},h;if("function"==typeof Object.setPrototypeOf)h=Object.setPrototypeOf;else{var k;a:{var l={B:!0},m={};try{m.__proto__=l;k=m.B;break a}catch(a){}k=!1}h=k?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}
var n=h,p="undefined"!=typeof window&&window===this?this:"undefined"!=typeof global&&null!=global?global:this,q=this||self;function r(a,b){a=a.split(".");var c=q;a[0]in c||"undefined"==typeof c.execScript||c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)a.length||void 0===b?c[d]&&c[d]!==Object.prototype[d]?c=c[d]:c=c[d]={}:c[d]=b};function t(a,b){this.a={};this.l(b);this.i=[];this.data=this.a.data;this.m=a;this.b="";this.h=-1;this.s=!1;this.m.classList.add("ac");this.c=document.createElement("input");this.c.setAttribute("type","search");this.c.setAttribute("placeHolder",this.a.prompt);this.m.appendChild(this.c);this.g=document.createElement("div");this.g.style.maxHeight=this.a.maxHeight;this.g.classList.add("ac-items");this.m.appendChild(this.g);a={input:this.u,click:this.D,keydown:this.v,blur:this.C};for(var c in a)this.c.addEventListener(c,
a[c].bind(this));this.g.addEventListener("mousedown",this.F.bind(this))}e=t.prototype;e.u=function(){this.b=this.c.value.toLowerCase();u(this);if(this.a.open||!(this.b.length<this.a.minChars||this.g.childElementCount))v(this).map(this.w,this),this.a.onInput(this.b)};
e.w=function(a){var b=this,c=document.createElement("div");c.innerHTML=this.a.highlight?w(this,a[this.a.label]):a[this.a.label];c.setAttribute("data-value",this.i.findIndex(function(d){return d[b.a.label]==a[b.a.label]}));c.addEventListener("click",this.o.bind(this));this.g.appendChild(c)};function v(a){return a.i.filter(function(b){return-1!=b[a.a.search].toLowerCase().indexOf(a.b)})}
function w(a,b){var c=b.toLowerCase().indexOf(a.b),d=document.createElement("span");d.innerHTML=b.slice(c,c+a.b.length);return b.slice(0,c)+d.outerHTML+b.slice(c+a.b.length,b.length)}e.o=function(a){a=a.target.getAttribute("data-value");var b=this.i[a];this.c.value=b[this.a.label];this.b=this.c.value.toLowerCase();this.s=!1;u(this);this.a.onSelect(b[this.a.field],b,a)};e.D=function(){if(this.g.childElementCount)return u(this);this.a.open&&!this.b?this.i.map(this.w,this):this.u(null)};
e.v=function(a){var b=this.g.childNodes;-1!=[40,38,13,27].indexOf(a.keyCode)&&a.preventDefault();switch(a.keyCode){case 40:-1==this.h&&this.u(null);this.h++;x(this,b);break;case 38:this.h--;x(this,b);break;case 13:if(-1!=this.h)b[this.h].click();else{if(this.a.custom){if(this.c.value.length>=this.a.minChars)this.a.onSelect(this.c.value,void 0,-1)}else 1==this.g.childElementCount&&b[0].click();u(this)}break;case 27:u(this)}};e.C=function(){this.s||u(this)};e.F=function(){this.s=!0};
function x(a,b){if(b.length){for(var c=0,d=b.length;c<d;c++)b[c].classList.remove("ac-active");a.h=0>a.h?b.length-1:a.h>b.length-1?0:a.h;b[a.h].classList.add("ac-active");b[a.h].scrollIntoView()}}function u(a){for(a.h=-1;a.g.firstChild;)a.g.removeChild(a.g.firstChild)}e.l=function(a){this.a=Object.assign(this.a,{prompt:"",open:!1,highlight:!0,custom:!1,maxHeight:"500px",minChars:3,label:"text",search:"text",field:"text",data:[],onInput:function(){},onSelect:function(){}},a)};
p.Object.defineProperties(t.prototype,{value:{configurable:!0,enumerable:!0,set:function(a){this.c.value=a;this.b=a.toLowerCase()},get:function(){var a=this,b=this.i.findIndex(function(c){return c[a.a.label].toLowerCase()==a.b});return-1!=b?this.i[b][this.a.field]:this.a.custom?this.c.value:null}},data:{configurable:!0,enumerable:!0,set:function(a){this.i=a;this.a.search!=this.a.label&&(this.a.highlight=!1)}}});r("AutoComplete",t);t.prototype.setOptions=t.prototype.l;function y(a,b){t.call(this,a,b);this.f=[];this.A=[];this.j=document.createElement("div");this.j.classList.add("ac-labels");this.m.appendChild(this.j)}y.prototype=g(t.prototype);y.prototype.constructor=y;if(n)n(y,t);else for(var z in t)if("prototype"!=z)if(Object.defineProperties){var A=Object.getOwnPropertyDescriptor(t,z);A&&Object.defineProperty(y,z,A)}else y[z]=t[z];
function B(a,b){var c=document.createElement("div");c.innerHTML=b[a.a.label];a.j.appendChild(c);a.f.push(b);a.A.push(c);c.addEventListener("click",function(){C(a,b);a.c.focus()});D(a);a.a.onLabel(b,a.f,!0);a.c.focus()}function C(a,b){b=a.f.indexOf(b);a.j.removeChild(a.A.splice(b,1)[0]);D(a);a.a.onLabel(a.f.splice(b,1)[0],a.f,!1)}function D(a){a.c.style["padding-left"]=a.j.offsetWidth+5+"px"}
y.prototype.o=function(a){t.prototype.o.call(this,a);a=a.target.getAttribute("data-value");a=this.i[a];-1==this.f.indexOf(a)&&B(this,a);this.c.value=this.b=""};
y.prototype.v=function(a){t.prototype.v.call(this,a);8==a.keyCode&&!this.b.length&&this.f.length&&(a.preventDefault(),this.b=this.c.value=this.f.slice(-1)[0][this.a.label],C(this,this.f.slice(-1)[0]));13==a.keyCode&&this.a.custom&&this.b.length>=this.a.minChars&&-1==this.f.indexOf(this.b)&&(a={},B(this,(a[this.a.label]=this.b,a)),this.c.value=this.b="")};y.prototype.l=function(a){t.prototype.l.call(this,a);Object.assign(this.a,{onLabel:function(){}},a)};
p.Object.defineProperties(y.prototype,{value:{configurable:!0,enumerable:!0,get:function(){return this.f},set:function(a){for(;this.f.length;)C(this,this.f[0]);var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];a=b?b.call(a):{next:f(a)};for(b=a.next();!b.done;b=a.next())b=b.value,-1==this.f.indexOf(b)&&B(this,b)}}});r("AutoCompleteLabel",y);y.prototype.setOptions=y.prototype.l;}).call(this);
